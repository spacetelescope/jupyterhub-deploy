jupyterhub:
  hub:
    pdb:
      enabled: true
      minAvailable: 0
    extraConfig:
      spawning: |
        c.KubeSpawner.start_timeout = 15 * 60  # Up to 15 minutes
      get_email: |
        def get_email(response):
            return response['attrib']['email']
      set_username_key: |
          c.GenericOAuthenticator.username_key = get_email
      fast_fail_bad_spawn: |
        c.JupyterHub.spawner_class = CustomSpawner
  proxy:
    chp:
      pdb:
        enabled: true
        minAvailable: 0
  singleuser:
    storage:
      type: "static"
      static:
        pvcName: "users-jh-pvc"
        subPath: "{username}"
      extraVolumes:
        - name: quota-control
          persistentVolumeClaim:
            claimName: quota-control-jh-pvc
      extraVolumeMounts:
        - name: quota-control
          mountPath: "/quota-control"
          subPath: "{username}"
          readOnly: true
    defaultUrl: "/lab"
  scheduling:
    userScheduler:
      enabled: true
      pdb:
        enabled: true
    corePods:
      nodeAffinity:
        matchNodePurpose: require
    userPods:
      nodeAffinity:
        matchNodePurpose: require
    podPriority:
      enabled: true
      globalDefault: true
      defaultPriority: 10
      userPlaceholderPriority: 0
